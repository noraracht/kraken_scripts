head(read.csv(" /Users/admin/Documents/Skimming/tree_of_life/tree_k_titration_recalc_viral/export_df_all_data.csv "))
head(read.csv(" /Users/admin/Documents/Skimming/tree_of_life/tree_k_titration_recalc_viral/export_df_all_data.csv"))
head(read.csv("/Users/admin/Documents/Skimming/tree_of_life/tree_k_titration_recalc_viral/export_df_all_data.csv"))
r=read.csv("/Users/admin/Documents/Skimming/tree_of_life/tree_k_titration_recalc_viral/export_df_all_data_extended.csv")
names(r)
qplot(FPR,recall,data=r)
qplot(FPR,recall,data=r)
qplot(FPR,recall,data=r)+facet_wrap(~confidence_level)
qplot(FPR,recall,data=r)+facet_wrap(~confidence_level,nrow=1)
qplot(FPR,recall,color=k,data=r)+facet_wrap(~confidence_level,nrow=1)
qplot(FPR,recall,color=as.factor(k),data=r)+facet_wrap(~confidence_level,nrow=1)
qplot(FPR,recall,color=as.factor(k),data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line()
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line()+xlim(c(0,0.5))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line()+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(aes(color=as.factor(bin)))+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(aes(color=(bin)))+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(aes(fill=(bin)))+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(aes(linetype=as.factor(bin)))+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(aes(linetype=as.factor(bin)),color=1)+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),shape=bin,group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))+scale_shape_ordinal()
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))+scale_shape_discrete()
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))+scale_shape_manual(values=1:10)
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.75))+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.2))+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r)+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+xlim(c(0,0.2))+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")+theme_bw()
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r[r$FPR<0.2,])+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")+theme_bw()
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r[r$FPR<0.2,])+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")+theme_bw()
qplot(FPR,recall,color=as.factor(k),shape=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line(color=1)+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Dark2")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1,scales = "free_x")+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.5&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(paste(bin_min,bin_max)),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()
qplot(FPR,recall,shape=as.factor(k),color=as.factor(paste(bin_min,bin_max)),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(paste(bin_min,bin_max)),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired")+theme_bw()+theme(legend.position = "bottom")
paste(r$bin_min,r$bin_max)
paste(r$bin_min,r$bin_max,sep=",")
paste(r$bin_min,r$bin_max,sep=",")
opts(digits=2)
options(digits=2)
paste(r$bin_min,r$bin_max,sep=",")
?paste
formate(r$bin_mean,digits=1)
format(r$bin_mean,digits=1)
format(r$bin_mean,digits=1)
paste(format(r$bin_mean,digits=1),format(r$bin_max,digits=1),sep=",")
paste(format(r$bin_mean,digits=1),format(r$bin_max,digits=1),sep="-")
paste(format(r$bin_mean,digits=0),format(r$bin_max,digits=0),sep="-")
paste(format(r$bin_mean,digits=1),format(r$bin_max,digits=1),sep="-")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(paste(bin_min,bin_max)),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25")+theme_bw()+theme(legend.position = "bottom")
)
qplot(FPR,recall,shape=as.factor(k),color=as.factor(paste(bin_min,bin_max)),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(b),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", name="",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(b),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", name="",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bind),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", name="",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_manual(values=1:10)+scale_color_brewer(palette = "Paired", name="",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=levels(k))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=levels(r$k))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
unique(r$k)
unique(r$k)
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=unique(r$k))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
rev(unique(r$k))
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=rev(unique(r$k)))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha2.pdf")
ggsave("ROC-peralpha2.pdf",width = 5.7,height = 5)
ggsave("ROC-peralpha2.pdf",width = 10,height = 5)
ggsave("ROC-peralpha2.pdf",width = 7,height = 4)
ggsave("ROC-peralpha2.pdf",width = 9,height = 4)
ggsave("ROC-peralpha2.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=rev(unique(r$k)))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha-supplementary2.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(-k),color=as.factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=rev(unique(r$k)))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha-supplementary2.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(k),color=as.factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha-supplementary2.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=factor(k,levels = rev(unique(k))),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=factor(k,levels = (unique(k))),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
unique(k)
unique(r$k)
qplot(FPR,recall,shape=factor(k,ordered = T, levels = (unique(k))),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=reorder(as.factor(k),FPR),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=reorder(as.factor(k),recall),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<1.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")+coord_cartesian(xlim(0,0.8))
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<1.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")+coord_cartesian(xlim=c(0,0.08))
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<1.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")+coord_cartesian(xlim=c(0,0.09))
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line(linetype=2)+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line(linetype=3)+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha_extended.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(-k),color=factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20&r$k!=23,])+facet_wrap(~confidence_level,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-peralpha-full_extended.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="k",labels=c("35","32","29","28","27","26"))+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-perk_extended.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-perk-full_extended.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Dark2", name="dist to closest match")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Dark2", name="dist to closest match")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breks=c(0.01,0.05))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.05))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.05,0.07))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1,labeller = function(x) {})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
head(read.csv("/Users/admin/Documents/Skimming/tree_of_life/tree_k_titration_recalc_viral/export_df_all_data.csv"))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1,labeller = function(x) {x$"variable"=c("Phylogenetic","Sequence (Mash computed)");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1,labeller = function(x) {x$"variable"=c("Phylogenetic","Sequence (Mash computed)");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1,labeller = function(x) {x$bin=c("Phylogenetic","Sequence (Mash computed)");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=1,labeller = function(x) {x$bin=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
ggsave("ROC-perbin_extended.pdf")
ggsave("ROC-perbin_extended.pdf",width=8,height = 3.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=2,labeller = function(x) {x$bin=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.09,0.17))
ggsave("ROC-perbin_extended.pdf",width=8,height = 6)
ggsave("ROC-perbin_extended.pdf",width=8,height = 4.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<1.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=2,labeller = function(x) {x$bin=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.01,0.04,0.07))
ggsave("ROC-perbin-full_extended.pdf",width=8,height = 4.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(k),group=k,data=r[r$FPR<1.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~bin,nrow=2,labeller = function(x) {x$bin=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25");x})+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Dark2", name="k")+theme_bw()+theme(legend.position = "bottom")+scale_x_continuous(breaks=c(0.2,0.5,0.8))
ggsave("ROC-perbin-full_extended.pdf",width=8,height = 4.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="k")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<0.2&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-perk_extended.pdf",width = 9,height = 3.5)
qplot(FPR,recall,shape=as.factor(confidence_level),color=factor(bin),group=bin,data=r[r$FPR<1.1&r$confidence_level<0.4&r$k!=20,])+facet_wrap(~k,nrow=1)+geom_line()+scale_shape_discrete(name="confidence")+scale_color_brewer(palette = "Paired", name="dist to closest match",labels=c("0","(0-1]","(1-2]","(2-3]","(3-5]","(5-10]","(10-15]","(15-20]","(20-25]",">25"))+theme_bw()+theme(legend.position = "bottom")
ggsave("ROC-perk-full_extended.pdf",width = 9,height = 3.5)
ggsave("ROC-perk-full_extended.pdf",width = 9,height = 3.5)
